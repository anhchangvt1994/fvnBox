$(function(t){var i,e,n,a="",o="",s="",d=!1,m={};t.fn.fvnBox=function(i,e){if(t(this).length>1)return void t(this).each(function(e,n){t(n).fvnBox({suffixImg:i.suffixImg,number:i.number,caption:i.caption},e)});0==t("body").find(".fullImg").length&&(t("body").append('<div class="fullImg hidden"><span class="close-lightBox"></span><div class="imgBox"></div></div><div class="fvnInforBox hidden"><span class="fvnNumber"></span><span class="fvnCaption"></span></div><div class="navBox hidden"><span class="prevBtn">&nbsp;</span><span class="close-lightBox"></span><span class="nextBtn">&nbsp;</span></div>'),c.init({opt:"setSizePercent"}),t(window).resize(function(){c.setResizeImg()}),c.detectDevice()?t(".fullImg").addClass("fvnNavBox"):t(".navBox").addClass("fvnNavBox"),c.settingRemoveFunc()),void 0===e&&(e="1");for(var n="fvnBox"+(e<10?"0"+e:e);0!=t(t("body").find("."+n)).length;)n="fvnBox"+(++e<10?"0"+e:e);t(this).addClass(n);var a=t(t(n="."+n).find("img"));void 0===i?i={suffixImg:void 0}:setTimeout(function(){c.init({opt:"setSuffix",suffix:i.suffixImg})},0),l.init(n,i,a)};var l={init:function(t,i,e){this.setup(t,i,e)},setup:function(e,n,m){function l(){t(".navBox"+a).on("touchstart",function(i){t("body").addClass("preventWindowScroll"),g=i.originalEvent.touches[0].pageX,v=0}).on("touchmove",function(t){var i=r.dragAnimate({event:t,prevPoint:g,distance:v,outImg:!1});g=i.prevPoint,v=i.distance}).on("touchend",function(){t("body").removeClass("preventWindowScroll");r.dragAnimate({prevPoint:g,distance:v,outImg:!0,imgs:o,opt:s})}),t(".fullImg").on("touchstart",".close-lightBox",function(){return a=f.settingClose(a,t(this)),!1})}function u(){t(".navBox"+a).on("click",".prevBtn, .nextBtn, .close-lightBox",function(){if("close-lightBox"!=t(this)[0].className){var e=f.detectContinueImg(a,i,t(this));void 0!==e&&r.mainAnimate({item:t(e),imgs:o,opt:s})}else a=f.settingClose(a,t(this))})}var g,v,p=0!=t(e).find("a").length?"a":0!=t(e).find("li").length?"li":0!=t(e).find("div").length?"div":0!=t(e).find("dd").length?"dd":"img";f.detectEvent({obj:e,tg:p}),t(e).find("img").on("touchstart click",function(i){if(a=e,o=m,s=n,t(".navBox").addClass(e.split(".")[1]),!c.detectDevice())return r.mainAnimate({item:t(this),imgs:m,opt:n}),d||(setTimeout(function(){u(),l()},0),d=!0),!1;var f=!1;t(this);t(document).on("touchmove",function(){f=!0}),t(this).on("touchend",function(){return f?f=!1:r.mainAnimate({item:t(this),imgs:m,opt:n}),d||(setTimeout(function(){u(),l()},0),d=!0),!1})})}},r={mainAnimate:function(e){if(void 0===e.type){var n,a,o=50;e.opt.caption&&(a=e.item.attr("alt")),void 0!==e.opt.suffixImg?(void 0===e.item.attr("data-src")&&e.item.attr("data-src",f.detectSuffixImage(e.item,e.opt.suffixImg)),t("body").find(".fullImg").append("<img src="+e.item.attr("data-src")+">").removeClass("hidden"),n=e.item.attr("data-src"),o=0):(t("body").find(".fullImg").append(e.item[0].outerHTML),n=e.item.attr("src")),t(t(".fullImg").find("img")).length>2&&t(".fullImg").find("img")[0].remove(),f.settingTimer(e.opt,n,o,a,t(e.imgs).length),e.imgs.each(function(n){e.item.attr("src")==t(this).attr("src")&&(i=n)})}},dragAnimate:function(e){if(void 0===e.type){if(!e.outImg){var n,o,s=e.event.originalEvent.touches[0].pageX;return void 0===t(t(".fullImg").find("img"))[1]?(t(t(".fullImg").find("img")).removeClass("returnAnimate quickMove").addClass("noneAnimate"),t(t(".fullImg").find(".imgBox")).removeClass("returnAnimate quickMove").addClass("noneAnimate")):(t(t(".fullImg").find("img")[0]).removeClass("returnAnimate").addClass("quickMove"),t(t(".fullImg").find(".imgBox")[0]).removeClass("returnAnimate").addClass("quickMove")),n=t(".fullImg img").offset().left,o=t(".fullImg .imgBox").offset().left,s>e.prevPoint?(n+=5,o+=5,e.distance=e.distance+1):(n-=5,o-=5,e.distance=e.distance-1),t(".fullImg img").offset({left:n}),t(".fullImg .imgBox").offset({left:o}),t(".navBox").offset({left:o}),{prevPoint:e.event.originalEvent.touches[0].pageX,distance:e.distance}}var d,m=!1;if(d=t(".fullImg img").hasClass("quickMove")?3:7,t(".fullImg img").removeClass("noneAnimate quickMove"),t(".fullImg .imgBox").removeClass("noneAnimate quickMove"),e.distance>=d?(t(".fullImg img").addClass("outAnimate").css("left","100%"),t(".fullImg .imgBox").addClass("outAnimate").css("left","100%"),m=!0):e.distance<=-d?(t(".fullImg img").addClass("outAnimate").css("left",0),t(".fullImg .imgBox").addClass("outAnimate").css("left",0),m=!0):(t(".fullImg img").addClass("returnAnimate").css("left",""),t(".fullImg .imgBox").addClass("returnAnimate").css("left","")),m){var l=t(".fullImg img");imgBox=t(".fullImg .imgBox"),t(".navBox").addClass("noneAnimate"),t(".fullImg").append("<div class='imgBox'></div>");var c=imgBox[0].clientHeight,u=imgBox[0].clientWidth;setTimeout(function(){var n=f.detectContinueImg(a,i,e.distance>=d?[{className:"nextBtn"}]:[{className:"prevBtn"}]);r.mainAnimate({item:t(n),imgs:e.imgs,opt:e.opt})},50),setTimeout(function(){l.css({height:l.height()/3,width:l.width()/3}),imgBox.css({height:imgBox[0].clientHeight/2+"px !important",width:imgBox[0].clientWidth/2+"px !important"})},70),setTimeout(function(){imgBox.css({height:c,width:u})},600),setTimeout(function(){l.addClass("remove"),imgBox.addClass("remove")},980),setTimeout(function(){t(".fullImg .remove").remove()},1e3)}t(".navBox").css("left","")}}},f={detectEvent:function(i){"img"!=i.tg&&c.detectDevice()&&t(i.obj).find(i.tg).click(function(i){i.preventDefault(),t(this).find("img").click()})},detectSuffixImage:function(i,e){var n,a=i.attr("src"),o=a.split("/")[t(this).length];if(void 0!==m)return t.each(m[e],function(t,i){if(o.split(".")[0]==i)return void(n=a.split(o)[0]+o.split(".")[0]+"-"+e+"."+o.split(".")[1])}),void 0===n&&(n=a),n;n=a},detectImageSize:function(t,i){if(t>e&&(currentPercent=e/t*100,t=e,i=i*currentPercent/100),i>n&&(currentPercent=n/i*100,i=n,t=t*currentPercent/100),!(t>e||i>n))return{trueWidth:t,trueHeight:i};arguments.callee(t,i)},detectContinueImg:function(i,e,n){if(""!=i)return"prevBtn"==n[0].className?e>0?e--:e=t(i).find("img").length-1:"nextBtn"==n[0].className&&(e<t(i).find("img").length-1?e++:e=0),t(i).find("img")[e]},settingTimer:function(e,n,a,o,s){t(".fullImg").find("img[src*='"+n+"']").load(function(){trueW=f.detectImageSize(t(this).prop("naturalWidth"),t(this).prop("naturalHeight")).trueWidth,trueH=f.detectImageSize(t(this).prop("naturalWidth"),t(this).prop("naturalHeight")).trueHeight,t("body").find(".fullImg").removeClass("hidden"),t("body").find(".navBox").removeClass("hidden"),t("body").find(".fvnInforBox").removeClass("hidden"),t("body").find(".fullImg img").css({width:parseInt(trueW),height:parseInt(trueH)}),setTimeout(function(){var i=0;2==t(t(".fullImg").find("img")).length&&(t(t(".fullImg").find("img")[0]).removeClass("appearOpa").addClass("disappearOpa"),i=1),t(t(".fullImg").find("img")[i]).addClass("appearOpa")},200),setTimeout(function(){t("body").find(".imgBox").css({width:parseInt(trueW)+10,height:parseInt(trueH)+10}),t("body").find(".navBox").css({width:parseInt(trueW)+10,height:parseInt(trueH)+10}),t("body").find(".fvnInforBox").css({width:parseInt(trueW)+10,height:parseInt(trueH)+10}),e.number?t("body").find(".fvnInforBox .fvnNumber").html(i+1+" of "+s):t("body").find(".fvnInforBox .fvnNumber").html(""),void 0!==o&&e.caption?t("body").find(".fvnInforBox .fvnCaption").html(o):t("body").find(".fvnInforBox .fvnCaption").html("")},a)})},settingClose:function(i,e){if(""!=i&&void 0!==i)return t(".navBox").removeClass(i.split(".")[1]),t(".fullImg").addClass("hidden").find("img").remove(),t(".fullImg").find(".imgBox").css({width:"",height:""}),t(".navBox").addClass("hidden"),t(".fvnInforBox").addClass("hidden"),i=""}},c={init:function(t){"setSuffix"==t.opt?this.setListSuffix(t.suffix):"setSizePercent"==t.opt&&this.setSizePercent()},setListSuffix:function(i){if(void 0===m[i]){m[i]={};var e=t("body img").attr("src"),n=e.split("/")[t(this).length];e=e.split(n)[0],t.get(e,function(e){t(e).find("a[href*="+i+"]").each(function(e,n){var a=t(n).attr("href").split("-"+i)[0];m[i][e]=a})})}},setSizePercent:function(){var i=t(window).outerWidth(!1),a=t(window).outerHeight(!0);e=i<a?80*i/100:i<=640?60*i/100:85*i/100,n=i<a?80*a/100:i<=640?60*a/100:85*a/100},detectDevice:function(){var t=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(t=!0),t},setResizeImg:function(){if(this.detectDevice()&&!t(".fullImg").hasClass("fvnNavBox")?(t(".navBox").removeClass("fvnNavBox"),t(".fullImg").addClass("fvnNavBox")):!this.detectDevice()&&t(".fullImg").hasClass("fvnNavBox")&&(t(".navBox").addClass("fvnNavBox"),t(".fullImg").removeClass("fvnNavBox")),this.setSizePercent(),!t(".fullImg").hasClass("hidden")){var i=f.detectImageSize(t("body").find(".fullImg .appearOpa").prop("naturalWidth"),t("body").find(".fullImg .appearOpa").prop("naturalHeight")).trueWidth,e=f.detectImageSize(t("body").find(".fullImg .appearOpa").prop("naturalWidth"),t("body").find(".fullImg .appearOpa").prop("naturalHeight")).trueHeight;t("body").find(".fullImg img").css({width:i,height:e}).addClass("fastAnimate"),t("body").find(".imgBox").css({width:i+10,height:e+10}).addClass("fastAnimate"),t("body").find(".navBox").css({width:i+10,height:e+10}).addClass("fastAnimate"),t("body").find(".fvnInforBox").css({width:i+10,height:e+10}).addClass("fastAnimate")}},settingRemoveFunc:function(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)})}}});